{"version":3,"sources":["../src/index.js"],"names":["Sword","Module","name","exports","method","methods","i","pathJoin","root","path","length","substring","paths","replace","dom","defaultModuleRelPath","defaultModulePathRoot","window","location","href","defaultModulePath","updateModulePath","moduleName","Promise","resolve","reject","script","document","createElement","src","type","getElementsByTagName","appendChild","onload","onerror","moduleNames","cb","getModule","console","error","call","bind","definer","module","Exports","sword"],"mappings":"AAAA;;;;;;AAMA;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,QAAS,YAAY;AAAA,QACjBC,MADiB;AAEnB,wBAAYC,IAAZ,EAAkB;AAAA;;AACd,iBAAKA,IAAL,GAAYA,IAAZ;AACA,iBAAKC,OAAL,GAAe,EAAf;AACH;;AALkB;AAAA;AAAA,mCAMZD,IANY,EAMNE,MANM,EAME;AACjB,qBAAKD,OAAL,CAAaD,IAAb,IAAqBE,MAArB;AACH;AARkB;AAAA;AAAA,oCASXC,OATW,EASF;AACb,qBAAK,IAAIC,CAAT,IAAcD,OAAd,EAAuB;AACnB,yBAAKF,OAAL,CAAaG,CAAb,IAAkBD,QAAQC,CAAR,CAAlB;AACH;AACJ;AAbkB;;AAAA;AAAA;;AAgBvB,aAASC,QAAT,CAAkBC,IAAlB,EAAkC;AAC9B,YAAIC,OAAOD,IAAX;AACA,YAAIC,KAAKA,KAAKC,MAAL,GAAc,CAAnB,KAAyB,GAA7B,EAAkC;AAC9BD,mBAAOA,KAAKE,SAAL,CAAe,CAAf,EAAkBF,KAAKC,MAAL,GAAc,CAAhC,CAAP;AACH;;AAJ6B,0CAAPE,KAAO;AAAPA,iBAAO;AAAA;;AAK9B,aAAK,IAAIN,IAAI,CAAb,EAAgBA,IAAIM,MAAMF,MAA1B,EAAkCJ,GAAlC,EAAuC;AACnCG,oBAAQ,MAAMG,MAAMN,CAAN,CAAd;AACA,gBAAIG,KAAKA,KAAKC,MAAL,GAAc,CAAnB,KAAyB,GAA7B,EAAkC;AAC9BD,uBAAOA,KAAKE,SAAL,CAAe,CAAf,EAAkBF,KAAKC,MAAL,GAAc,CAAhC,CAAP;AACH;AACJ;AACDD,eAAOA,KAAKI,OAAL,CAAa,mBAAb,EAAkC,GAAlC,EAAuCA,OAAvC,CAA+C,OAA/C,EAAwD,GAAxD,CAAP;AACA,eAAOJ,IAAP;AACH;;AA7BsB,QA+BjBT,KA/BiB;AAgCnB,uBAAYc,GAAZ,EAAiB;AAAA;;AACb,iBAAKA,GAAL,GAAWA,GAAX;AACA,iBAAKC,oBAAL,GAA4B,SAA5B;AACA,iBAAKC,qBAAL,GAA6BC,OAAOC,QAAP,CAAgBC,IAAhB,CAAqBN,OAArB,CAA6B,kBAA7B,EAAiD,EAAjD,EAAqDA,OAArD,CAA6D,WAA7D,EAA0E,EAA1E,CAA7B;AACA,iBAAKO,iBAAL,GAAyBb,SAAS,KAAKS,qBAAd,EAAqC,KAAKD,oBAA1C,CAAzB;AACH;;AArCkB;AAAA;AAAA,+CAsCA;AACf,qBAAKK,iBAAL,GAAyBb,SAAS,KAAKS,qBAAd,EAAqC,KAAKD,oBAA1C,CAAzB;AACH;AAxCkB;AAAA;AAAA,uCAyCRN,IAzCQ,EAyCF;AACb,qBAAKM,oBAAL,GAA4BN,IAA5B;AACA,qBAAKY,gBAAL;AACA,uBAAO,IAAP;AACH;AA7CkB;AAAA;AAAA,sCA8CTC,UA9CS,EA8CG;AAAA;;AAClB,uBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,wBAAIC,SAASC,SAASC,aAAT,CAAuB,QAAvB,CAAb;AACAF,2BAAOG,GAAP,GAAatB,SAAS,MAAKa,iBAAd,EAAiCE,UAAjC,EAA6CA,aAAa,KAA1D,CAAb;AACAI,2BAAOI,IAAP,GAAc,iBAAd;AACA,0BAAKhB,GAAL,CAASiB,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,WAAzC,CAAqDN,MAArD;AACAA,2BAAOO,MAAP,GAAgB,YAAY;AACxBT,gCAAQ,IAAR;AACH,qBAFD;AAGAE,2BAAOQ,OAAP,GAAiB,YAAY;AACzBV,gCAAQ,KAAR;AACH,qBAFD;AAGH,iBAXM,CAAP;AAYH;AA3DkB;AAAA;AAAA;AAAA,uGA4DTW,WA5DS,EA4DIC,EA5DJ;AAAA;AAAA;AAAA;AAAA;AAAA;AA6DN9B,qCA7DM,GA6DF,CA7DE;;AAAA;AAAA,0CA6DCA,IAAI6B,YAAYzB,MA7DjB;AAAA;AAAA;AAAA;;AAAA;AAAA,2CA8DC,KAAK2B,SAAL,CAAeF,YAAY7B,CAAZ,CAAf,CA9DD;;AAAA;AAAA;AAAA;AAAA;AAAA;;AA+DPgC,4CAAQC,KAAR,CAAc,0BAA0BJ,YAAY7B,CAAZ,CAA1B,GAA2C,UAAzD;;AA/DO;AA6DyBA,uCA7DzB;AAAA;AAAA;;AAAA;AAkEf,wCAAI8B,EAAJ,EAAQA,GAAGI,IAAH,CAAQ,IAAR;AAlEO,qEAmER,IAnEQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yGAqELL,WArEK;AAAA;AAAA;AAAA;AAAA;AAAA,sEAsER,IAAIZ,OAAJ,CAAY;AAAA,iIAAgBC,OAAhB,EAAyBC,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AACNnB,6DADM,GACF,CADE;;AAAA;AAAA,kEACCA,IAAI6B,YAAYzB,MADjB;AAAA;AAAA;AAAA;;AAAA;AAAA,mEAEC,KAAK2B,SAAL,CAAeF,YAAY7B,CAAZ,CAAf,CAFD;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAGPgC,oEAAQC,KAAR,CAAc,0BAA0BJ,YAAY7B,CAAZ,CAA1B,GAA2C,UAAzD;;AAHO;AACyBA,+DADzB;AAAA;AAAA;;AAAA;AAMfkB,oEAAQ,IAAR;;AANe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,wCAOjBiB,IAPiB,CAOZ,IAPY,CAAZ,CAtEQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uCA+ERN,WA/EQ,EA+EK;AACpB,qBAAK,IAAI7B,IAAI,CAAb,EAAgBA,IAAI6B,YAAYzB,MAAhC,EAAwCJ,GAAxC,EAA6C;AACzCW,2BAAOkB,YAAY7B,CAAZ,CAAP,IAAyB,KAAK6B,YAAY7B,CAAZ,CAAL,CAAzB;AACH;AACD,uBAAO,IAAP;AACH;AApFkB;AAAA;AAAA,mCAqFZgB,UArFY,EAqFAoB,OArFA,EAqFS;AACxB,oBAAIC,SAAS,IAAI1C,MAAJ,CAAWqB,UAAX,CAAb;AACAoB,wBAAQ,SAASvC,OAAT,CAAiBE,OAAjB,EAA0B;AAC9BsC,2BAAOC,OAAP,CAAevC,OAAf;AACH,iBAFO,CAENoC,IAFM,CAED,IAFC,CAAR;AAGA,qBAAKnB,UAAL,IAAmBqB,OAAOxC,OAA1B;AACA,uBAAO,IAAP;AACH;AA5FkB;;AAAA;AAAA;;AA+FvB,WAAOH,KAAP;AACH,CAhGa,EAAd;;AAkGO,IAAM6C,wBAAQ,IAAI7C,KAAJ,CAAU2B,QAAV,CAAd,C,CAAkC;;AAEzCV,OAAOjB,KAAP,GAAeA,KAAf;AACAiB,OAAO4B,KAAP,GAAeA,KAAf","file":"index.js","sourcesContent":["/**\n * @name Sword\n * @description A front-end framework for rapid development like a sword\n * @author yhzheng\n * @license Apache-2.0\n * */\n\"use strict\";\n\nconst Sword = (function () {\n    class Module {\n        constructor(name) {\n            this.name = name;\n            this.exports = {};\n        }\n        Export(name, method) {\n            this.exports[name] = method;\n        }\n        Exports(methods) {\n            for (let i in methods) {\n                this.exports[i] = methods[i];\n            }\n        }\n    }\n\n    function pathJoin(root, ...paths) {\n        let path = root;\n        if (path[path.length - 1] == \"/\") {\n            path = path.substring(0, path.length - 1);\n        }\n        for (let i = 0; i < paths.length; i++) {\n            path += \"/\" + paths[i];\n            if (path[path.length - 1] == \"/\") {\n                path = path.substring(0, path.length - 1);\n            }\n        }\n        path = path.replace(/\\/[^\\/]+\\/\\.\\.\\//g, \"/\").replace(/\\/\\//g, \"/\");\n        return path;\n    }\n\n    class Sword {\n        constructor(dom) {\n            this.dom = dom;\n            this.defaultModuleRelPath = \"modules\";\n            this.defaultModulePathRoot = window.location.href.replace(/https?:\\/\\/[^/]+/, \"\").replace(/\\/[^\\/]+$/, \"\");\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n        }\n        updateModulePath() {\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n        }\n        modulePath(path) {\n            this.defaultModuleRelPath = path;\n            this.updateModulePath();\n            return this;\n        }\n        getModule(moduleName) {\n            return new Promise((resolve, reject) => {\n                let script = document.createElement(\"script\");\n                script.src = pathJoin(this.defaultModulePath, moduleName, moduleName + \".js\");\n                script.type = 'text/javascript';\n                this.dom.getElementsByTagName(\"body\")[0].appendChild(script);\n                script.onload = function () {\n                    resolve(true);\n                };\n                script.onerror = function () {\n                    resolve(false);\n                };\n            });\n        }\n        async use(moduleNames, cb) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                if (!(await this.getModule(moduleNames[i]))) {\n                    console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                }\n            }\n            if (cb) cb.call(this);\n            return this;\n        }\n        async useSync(moduleNames) {\n            return new Promise(async function (resolve, reject) {\n                for (let i = 0; i < moduleNames.length; i++) {\n                    if (!(await this.getModule(moduleNames[i]))) {\n                        console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                    }\n                }\n                resolve(true);\n            }.bind(this));\n        }\n        loadGlobal(moduleNames) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                window[moduleNames[i]] = this[moduleNames[i]];\n            }\n            return this;\n        }\n        define(moduleName, definer) {\n            let module = new Module(moduleName);\n            definer(function exports(methods) {\n                module.Exports(methods);\n            }.bind(this));\n            this[moduleName] = module.exports;\n            return this;\n        }\n    }\n\n    return Sword;\n})();\n\nexport const sword = new Sword(document);// 定义默认sword实例\n\nwindow.Sword = Sword;\nwindow.sword = sword;"]}