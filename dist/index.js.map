{"version":3,"sources":["../src/index.js"],"names":["Sword","Module","name","exports","method","methods","i","pathJoin","root","path","length","substring","paths","replace","dom","solitary","defaultModuleRelPath","defaultModulePathRoot","window","location","href","defaultModulePath","instances","push","updateModulePath","moduleName","Promise","resolve","reject","script","document","createElement","src","type","getElementsByTagName","appendChild","onload","onerror","moduleNames","cb","getModule","console","error","call","bind","definer","module","Exports","sword"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @name Sword\n * @description A front-end framework for rapid development like a sword\n * @author yhzheng\n * @license Apache-2.0\n * */\n\"use strict\";\n\nconst Sword = (function () {\n    class Module {\n        constructor(name) {\n            this.name = name;\n            this.exports = {};\n        }\n        Export(name, method) {\n            this.exports[name] = method;\n        }\n        Exports(methods) {\n            for (let i in methods) {\n                this.exports[i] = methods[i];\n            }\n        }\n    }\n\n    function pathJoin(root, ...paths) {\n        let path = root;\n        if (path[path.length - 1] == \"/\") {\n            path = path.substring(0, path.length - 1);\n        }\n        for (let i = 0; i < paths.length; i++) {\n            path += \"/\" + paths[i];\n            if (path[path.length - 1] == \"/\") {\n                path = path.substring(0, path.length - 1);\n            }\n        }\n        path = path.replace(/\\/[^\\/]+\\/\\.\\.\\//g, \"/\").replace(/\\/\\//g, \"/\");\n        return path;\n    }\n\n    class Sword {\n        constructor(dom, solitary = false) {\n            this.dom = dom;\n            this.defaultModuleRelPath = \"modules\";\n            this.defaultModulePathRoot = window.location.href.replace(/https?:\\/\\/[^/]+/, \"\").replace(/\\/[^\\/]+$/, \"\");\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n            this.solitary = solitary;\n            if (!solitary) {\n                for (let i in Sword.exports) {\n                    this[i] = Sword.exports[i];\n                }\n            }\n            Sword.instances.push(this);\n        }\n        updateModulePath() {\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n        }\n        modulePath(path) {\n            this.defaultModuleRelPath = path;\n            this.updateModulePath();\n            return this;\n        }\n        getModule(moduleName) {\n            return new Promise((resolve, reject) => {\n                let script = document.createElement(\"script\");\n                script.src = pathJoin(this.defaultModulePath, moduleName, moduleName + \".js\");\n                script.type = 'text/javascript';\n                this.dom.getElementsByTagName(\"body\")[0].appendChild(script);\n                script.onload = function () {\n                    resolve(true);\n                };\n                script.onerror = function () {\n                    resolve(false);\n                };\n            });\n        }\n        async use(moduleNames, cb) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                if (!(await this.getModule(moduleNames[i]))) {\n                    console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                }\n            }\n            if (cb) cb.call(this);\n            return this;\n        }\n        async useSync(moduleNames) {\n            return new Promise(async function (resolve, reject) {\n                for (let i = 0; i < moduleNames.length; i++) {\n                    if (!(await this.getModule(moduleNames[i]))) {\n                        console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                    }\n                }\n                resolve(true);\n            }.bind(this));\n        }\n        loadGlobal(moduleNames) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                window[moduleNames[i]] = this[moduleNames[i]];\n            }\n            return this;\n        }\n        define(moduleName, definer) {// 会为所有对象加入模块，除法该实例solitary为true\n            if ((new Sword(document, true))) {}\n            let module = new Module(moduleName);\n            definer(function exports(methods) {\n                module.Exports(methods);\n            }.bind(this));\n            if (this.solitary) {// solitary的实例不与其他实例发生作用\n                this[moduleName] = module.exports;\n                return this;\n            }\n            Sword.exports[moduleName] = module.exports;// 让Sword类自己也存一份，这么创建实例时就可以自动引入模块了，但是solitary的实例不会自动引入，也不会为Sword加入静态值\n            for (let i = 0; i < Sword.instances.length; i++) {\n                if (Sword.instances[i].solitary) continue;\n                Sword.instances[i][moduleName] = module.exports;\n            }\n            return this;\n        }\n    }\n    Sword.instances = [ ];\n    Sword.exports = { };\n    Sword.pathJoin = pathJoin;\n\n    return Sword;\n})();\n\nconst sword = new Sword(document);// 定义默认sword实例\n\nwindow.sword = sword;\nwindow.Sword = Sword;\n\nexport {\n    sword, Sword\n};"]}