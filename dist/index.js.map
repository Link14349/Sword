{"version":3,"sources":["../src/index.js"],"names":["Sword","Module","name","exports","method","methods","i","pathJoin","root","path","length","substring","paths","replace","dom","defaultModuleRelPath","defaultModulePathRoot","window","location","href","defaultModulePath","moduleName","Promise","resolve","reject","script","document","createElement","src","type","getElementsByTagName","appendChild","onload","onerror","moduleNames","cb","getModule","console","error","call","bind","definer","module","Exports","sword"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @name Sword\n * @description A front-end framework for rapid development like a sword\n * @author yhzheng\n * @license Apache-2.0\n * */\n\"use strict\";\n\nconst Sword = (function () {\n    class Module {\n        constructor(name) {\n            this.name = name;\n            this.exports = {};\n        }\n        Export(name, method) {\n            this.exports[name] = method;\n        }\n        Exports(methods) {\n            for (let i in methods) {\n                this.exports[i] = methods[i];\n            }\n        }\n    }\n\n    function pathJoin(root, ...paths) {\n        let path = root;\n        if (path[path.length - 1] == \"/\") {\n            path = path.substring(0, path.length - 1);\n        }\n        for (let i = 0; i < paths.length; i++) {\n            path += \"/\" + paths[i];\n            if (path[path.length - 1] == \"/\") {\n                path = path.substring(0, path.length - 1);\n            }\n        }\n        path = path.replace(/\\/[^\\/]+\\/\\.\\.\\//, \"/\");\n        return path;\n    }\n\n    class Sword {\n        constructor(dom) {\n            this.dom = dom;\n            this.defaultModuleRelPath = \"modules\";\n            this.defaultModulePathRoot = window.location.href.replace(/https?:\\/\\/[^/]+/, \"\").replace(/\\/[^\\/]+$/, \"\");\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n        }\n        updateModulePath() {\n            this.defaultModulePath = pathJoin(this.defaultModulePathRoot, this.defaultModuleRelPath);\n        }\n        getModule(moduleName) {\n            return new Promise((resolve, reject) => {\n                let script = document.createElement(\"script\");\n                script.src = pathJoin(this.defaultModulePath, moduleName, moduleName + \".js\");\n                script.type = 'text/javascript';\n                this.dom.getElementsByTagName(\"body\")[0].appendChild(script);\n                script.onload = function () {\n                    resolve(true);\n                };\n                script.onerror = function () {\n                    resolve(false);\n                };\n            });\n        }\n        async use(moduleNames, cb) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                if (!(await this.getModule(moduleNames[i]))) {\n                    console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                }\n            }\n            if (cb) cb.call(this);\n            return this;\n        }\n        async useSync(moduleNames) {\n            return new Promise(async function (resolve, reject) {\n                for (let i = 0; i < moduleNames.length; i++) {\n                    if (!(await this.getModule(moduleNames[i]))) {\n                        console.error(\"Sword: Load module: '\" + moduleNames[i] + \"' failed\");\n                    }\n                }\n                resolve(true);\n            }.bind(this));\n        }\n        loadGlobal(moduleNames) {\n            for (let i = 0; i < moduleNames.length; i++) {\n                window[moduleNames[i]] = this[moduleNames[i]];\n            }\n            return this;\n        }\n        define(moduleName, definer) {\n            let module = new Module(moduleName);\n            definer(function exports(methods) {\n                module.Exports(methods);\n            }.bind(this));\n            this[moduleName] = module.exports;\n            return this;\n        }\n    }\n\n    return Sword;\n})();\n\nconst sword = new Sword(document);// 定义默认sword实例\n\nwindow.Sword = Sword;\nwindow.sword = sword;"]}