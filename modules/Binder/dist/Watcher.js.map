{"version":3,"sources":["../src/Watcher.js"],"names":["Watcher","data","bindingData","__data","__bindingData","oberver","Observer","__ons","__bindings","on","root","keys","value","bd","evalString","i","length","JSON","stringify","console","log","eval","haveListener","emit","name","cb","argv","newKeys","rk","nk"],"mappings":"AAAA;;;;;;;;;AAEA;;;;;;IAEaA,O,WAAAA,O;AACT,qBAAYC,IAAZ,EAAkBC,WAAlB,EAA+B;AAAA;;AAAA;;AAC3B,aAAKC,MAAL,GAAcF,IAAd;AACA,aAAKG,aAAL,GAAqBF,WAArB;AACA,aAAKG,OAAL,GAAe,IAAIC,kBAAJ,CAAaL,IAAb,CAAf;AACA,aAAKM,KAAL,GAAa,EAAb;AACA,aAAKC,UAAL,GAAkB,EAAlB;AACA,aAAKH,OAAL,CAAaI,EAAb,CAAgB,QAAhB,EAA0B,UAACC,IAAD,EAAOT,IAAP,EAAaU,IAAb,EAAmBC,KAAnB,EAA6B;AACnD,gBAAIC,KAAK,MAAKT,aAAd;AACA,gBAAIU,aAAa,IAAjB;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,KAAKK,MAAzB,EAAiCD,GAAjC,EAAsC;AAClCD,8BAAc,MAAMG,KAAKC,SAAL,CAAeP,KAAKI,CAAL,CAAf,CAAN,GAAgC,GAA9C;AACH;AACD,gBAAI,MAAKP,UAAL,CAAgBM,UAAhB,CAAJ,EAAiCA,aAAa,MAAKN,UAAL,CAAgBM,UAAhB,CAAb;AACjCK,oBAAQC,GAAR,CAAYN,UAAZ;AACAA,0BAAc,QAAQG,KAAKC,SAAL,CAAeN,KAAf,CAAtB;AACAS,iBAAKP,UAAL;AACA,gBAAI,MAAKQ,YAAL,CAAkB,QAAlB,CAAJ,EAAiC;AAC7B,sBAAKC,IAAL,CAAU,QAAV,EAAoB,CAAEb,IAAF,EAAQT,IAAR,EAAcU,IAAd,EAAoBC,KAApB,CAApB;AACH;AACJ,SAbD;AAcH;;;;2BACEY,I,EAAMC,E,EAAI;AACT,iBAAKlB,KAAL,CAAWiB,IAAX,IAAmBC,EAAnB;AACA,mBAAO,IAAP;AACH;;;6BACID,I,EAAME,I,EAAM;AAAA;;AACb,yBAAKnB,KAAL,EAAWiB,IAAX,iCAAoBE,IAApB;AACA,mBAAO,IAAP;AACH;;;qCACYF,I,EAAM;AACf,mBAAO,CAAC,CAAC,KAAKjB,KAAL,CAAWiB,IAAX,CAAT;AACH;;;6BACIb,I,EAAMgB,O,EAAS;AAChB,gBAAIC,KAAK,IAAT;AACA,iBAAK,IAAIb,IAAI,CAAb,EAAgBA,IAAIJ,KAAKK,MAAzB,EAAiCD,GAAjC,EAAsC;AAClCa,sBAAM,MAAMX,KAAKC,SAAL,CAAeP,KAAKI,CAAL,CAAf,CAAN,GAAgC,GAAtC;AACH;AACD,gBAAIc,KAAK,IAAT;AACA,iBAAK,IAAId,KAAI,CAAb,EAAgBA,KAAIY,QAAQX,MAA5B,EAAoCD,IAApC,EAAyC;AACrCc,sBAAM,MAAMZ,KAAKC,SAAL,CAAeS,QAAQZ,EAAR,CAAf,CAAN,GAAmC,GAAzC;AACH;AACD,iBAAKP,UAAL,CAAgBoB,EAAhB,IAAsBC,EAAtB;AACH","file":"Watcher.js","sourcesContent":["\"use strict\";\n\nimport { Observer } from \"./Observer\"\n\nexport class Watcher {\n    constructor(data, bindingData) {\n        this.__data = data;\n        this.__bindingData = bindingData;\n        this.oberver = new Observer(data);\n        this.__ons = { };\n        this.__bindings = { };\n        this.oberver.on(\"change\", (root, data, keys, value) => {\n            let bd = this.__bindingData;\n            let evalString = \"bd\";\n            for (let i = 0; i < keys.length; i++) {\n                evalString += \"[\" + JSON.stringify(keys[i]) + \"]\";\n            }\n            if (this.__bindings[evalString]) evalString = this.__bindings[evalString];\n            console.log(evalString);\n            evalString += \" = \" + JSON.stringify(value);\n            eval(evalString);\n            if (this.haveListener(\"change\")) {\n                this.emit(\"change\", [ root, data, keys, value ]);\n            }\n        });\n    }\n    on(name, cb) {\n        this.__ons[name] = cb;\n        return this;\n    }\n    emit(name, argv) {\n        this.__ons[name](...argv);\n        return this;\n    }\n    haveListener(name) {\n        return !!this.__ons[name];\n    }\n    bind(keys, newKeys) {\n        let rk = \"bd\";\n        for (let i = 0; i < keys.length; i++) {\n            rk += \"[\" + JSON.stringify(keys[i]) + \"]\";\n        }\n        let nk = \"bd\";\n        for (let i = 0; i < newKeys.length; i++) {\n            nk += \"[\" + JSON.stringify(newKeys[i]) + \"]\";\n        }\n        this.__bindings[rk] = nk;\n    }\n}"]}